"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1044],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(n),f=o,m=u["".concat(s,".").concat(f)]||u[f]||d[f]||a;return n?r.createElement(m,i(i({ref:t},p),{},{components:n})):r.createElement(m,i({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9010:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var r=n(7462),o=(n(7294),n(3905));const a={description:"How Colony's upgradeable contract's work",sidebar_position:2},i="Upgrade design",c={unversionedId:"concepts/upgrades",id:"concepts/upgrades",title:"Upgrade design",description:"How Colony's upgradeable contract's work",source:"@site/vendor/colonyNetwork/docs/concepts/upgrades.md",sourceDirName:"concepts",slug:"/concepts/upgrades",permalink:"/colonynetwork/concepts/upgrades",draft:!1,editUrl:"https://github.com/JoinColony/concepts/upgrades.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{description:"How Colony's upgradeable contract's work",sidebar_position:2},sidebar:"sidebar",previous:{title:"Extensions",permalink:"/colonynetwork/concepts/extensions"},next:{title:"Interfaces",permalink:"/colonynetwork/interfaces/"}},s={},l=[],p={toc:l};function d(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"upgrade-design"},"Upgrade design"),(0,o.kt)("p",null,"The contracts comprising the Colony Network are upgradeable using the Delegate Proxy design pattern."),(0,o.kt)("p",null,"Providing an upgrade path is important to allow for the continuous improvement of the Colony Network. At the same time, all depreciated versions of Colony should remain functional indefinitely after deployment, so that the organizations created are not predicated upon the actions/efforts of a third party."),(0,o.kt)("p",null,'In other words, upgrades to any individual colony on the network are "opt-in", while the network as a whole remains eternally backwards-compatible.'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Delegate Proxy Pattern")),(0,o.kt)("p",null,"Interacting with both the Colony Network and individual colonies on the network is somewhat different than many other smart contract interactions that a blockchain developer might not be accustomed to."),(0,o.kt)("p",null,"Rather than calling functions directly from the contract in which they are deployed, all transactions are signed and sent to the ",(0,o.kt)("inlineCode",{parentName:"p"},"EtherRouter")," contract."),(0,o.kt)("p",null,"Whenever a transaction is received by the ",(0,o.kt)("inlineCode",{parentName:"p"},"EtherRouter")," contract, it looks the function up in a ",(0,o.kt)("inlineCode",{parentName:"p"},"Resolver")," contract, using the function signature."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"Resolver")," contract contains a mapping of whitelisted function signatures to addresses (",(0,o.kt)("inlineCode",{parentName:"p"},"mapping ( bytes4 => address )"),")."),(0,o.kt)("p",null,"A function signature lookup will return the address of the contracts that implement the desired function. ",(0,o.kt)("inlineCode",{parentName:"p"},"EtherRouter")," in turn calls the function via ",(0,o.kt)("inlineCode",{parentName:"p"},"delegatecall"),", and passes any returns from the call back to ",(0,o.kt)("inlineCode",{parentName:"p"},"msg.sender"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"EtherRouter",src:n(873).Z,width:"2000",height:"1014"})),(0,o.kt)("p",null,"This pattern enables both fine-grained control of permissions for individual functions (see below), well as eternal backwards-compatibility following network upgrades."))}d.isMDXComponent=!0},873:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/delegateProxyCallchain_1-555de1a309f697612b35766cd004c54f.png"}}]);